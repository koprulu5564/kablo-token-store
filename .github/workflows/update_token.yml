name: ğŸ”„ MANUEL Token GÃ¼ncelleme
on: 
  workflow_dispatch: # Kritik: Bu satÄ±r manuel Ã§alÄ±ÅŸtÄ±rmayÄ± aktif eder
  schedule:
    - cron: '0 */24 * * *'

jobs:
  update:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
    - name: ğŸ› ï¸ Repoyu Ã‡ek
      uses: actions/checkout@v4

    - name: ğŸ Python Kurulumu
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: ğŸ“¦ Gerekli Paketler
      run: pip install requests

    - name: ğŸ”‘ Token Ã‡ekme (DÃ¼zeltilmiÅŸ)
      run: |
        python -c '
import requests, re
try:
    headers = {"Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}
    r = requests.get("https://core-api.kablowebtv.com/api/channels", headers=headers, timeout=20)
    r.raise_for_status()
    token = re.search(r"wmsAuthSign=([^&]+)", r.json()["Data"]["AllChannels"][0]["StreamData"]["HlsStreamUrl"]).group(1)
    with open("token.txt", "w") as f:
        f.write(token)
    print("âœ… BaÅŸarÄ±lÄ±!")
except Exception as e:
    print(f"âŒ Hata: {e}")
    exit(1)
        '

    - name: ğŸ’¾ DeÄŸiÅŸiklikleri Kaydet
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        git add token.txt
        git commit -m "ğŸ”„ Token gÃ¼ncellendi: $(date +'%d.%m.%Y %H:%M')"
        git push
